
# WebGPT & Toolformer

## 大致的流程

这一部分来自于台大李宏毅教授 2023 年的视频: [【生成式AI】能夠使用工具的AI：New Bing, WebGPT, Toolformer](https://www.youtube.com/watch?v=ZID220t_MpI)。

对于 [WebGPT](https://openai.com/research/webgpt) 来说, 有两个大语言模型, 一个是用来 **搜索** 的, 一个是用来 **回答** 的。

**搜索** 模型是也是一个 自回归的语言模型, 也是采用 **文字接龙** 的方式将内容一步一步生成的。具体的流程如下:

1. 用户提问: `高雄过去有哪些名称?`
2. 语言模型自己决定是否要搜索, 如果需要, 则输出: `[搜索] 高雄旧称 [END]`
3. 通过搜索引擎来搜索 "高雄旧称", 将搜索到的结果以及结果的 rank 组合在一起, 放在上一步输出的后面
4. 接下来, 模型输出: `[点选] 2 [END]`, 表示 rank 为 2 的搜索结果对回答问题可能有帮助
5. 接下来, 将 rank 为 2 的文章拼在模型输出的后面, 模型会决定这篇文章是否对回答问题有帮助, 如果有, 输出 `[收藏]`, 如果没有则什么都不输出
6. 如果模型觉得至此已经可以回答用户的提问了, 则输出 `[回答]`, 否则输出 `[搜索] 高雄的古地名 [END]`, 重复 2-5 步

接下来, 使用 **回答** 模型, 其也是一个 语言模型, 输入是 用户提问 + 收藏的文本, 输出的文字返回给用户。注意, 引用也是语言模型输出的 (人工标注写答案时也是需要写引用的)。

整个过程感觉和强化学习很像。**搜索** 语言模型就是一个 agent, 其决定 搜索的内容, 以及哪些文本被选中用来回答问题。整个过程也是模仿人类回答问题的过程的。我们对于知道的问题, 往往会直接输出, 对于不知道的问题, 自然是使用搜索引擎, 然后根据搜索到的内容来回答。

其实, 像 GPT 这样的自回归大语言模型, 和强化学习中的 agent 是非常吻合的。我们可以用这种方式创造出很多有意义的东西。~~问题是你有数据吗? 你有算力吗? 你所处的工作环境给你试错的机会吗?~~

[Toolformer](https://arxiv.org/abs/2302.04761) 和上面的思想是差不多的, 但是模型不是仅仅使用 **搜索** 工具, 还会使用其它工具, 比方说计算器。和上面不同的是, 只有一个语言模型了。大致的流程如下:

1. 用户提问: `我有 5 美金, 可以换多少新台币?`
2. 模型首先输出: `5 美金可以换`
3. 模型接着输出: `[搜索] 美金台币汇率 [END]`, 然后去网络上搜索
4. 将搜索到的结果 `1 美金 = 30 台币` 拼在模型输出的后面
5. 模型接下来输出: `[计算器] 5 * 30 [END]`
6. 用计算器计算 5 * 30 的结果, 将 `150` 拼在模型输出的后面
7. 最后输出 `元新台币`, 然后将中间调用工具的部分都去掉, 返回给用户

两者的想法差不多, 但是目的不同。你可以认为 WebGPT 是要构建一个 open-domain 的问答系统, 而 Toolformer 是基于 open-domain 的问答系统开发的调用插件的系统。

当然了, 这类问题的核心都是你训练数据怎么来, Toolformer 的作者不像 OpenAI 那么有钱, 可以雇人来标数据。它们的数据来自于 ChatGPT, 并用语言模型的概率来筛选质量高的数据。
